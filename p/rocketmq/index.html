<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="1. RocketMq ç®€ä»‹ 1. ç‰¹ç‚¹ æ”¯æŒå‘å¸ƒ/è®¢é˜…ï¼ˆPub/Subï¼‰å’Œç‚¹å¯¹ç‚¹ï¼ˆP2Pï¼‰æ¶ˆæ¯æ¨¡å‹\nèƒ½å¤Ÿä¿è¯ä¸¥æ ¼çš„æ¶ˆæ¯é¡ºåºï¼Œåœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­å¯é çš„å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰å’Œä¸¥æ ¼çš„é¡ºåºä¼ é€’\n">
<title>RocketMq</title>

<link rel='canonical' href='https://mikeLing-qx.github.io/p/rocketmq/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="RocketMq">
<meta property='og:description' content="1. RocketMq ç®€ä»‹ 1. ç‰¹ç‚¹ æ”¯æŒå‘å¸ƒ/è®¢é˜…ï¼ˆPub/Subï¼‰å’Œç‚¹å¯¹ç‚¹ï¼ˆP2Pï¼‰æ¶ˆæ¯æ¨¡å‹\nèƒ½å¤Ÿä¿è¯ä¸¥æ ¼çš„æ¶ˆæ¯é¡ºåºï¼Œåœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­å¯é çš„å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰å’Œä¸¥æ ¼çš„é¡ºåºä¼ é€’\n">
<meta property='og:url' content='https://mikeLing-qx.github.io/p/rocketmq/'>
<meta property='og:site_name' content='lexqinMike'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='rocketMq' /><meta property='article:tag' content='æ¶ˆæ¯é˜Ÿåˆ—' /><meta property='article:published_time' content='2024-07-14T16:23:18&#43;08:00'/><meta property='article:modified_time' content='2024-07-14T16:23:18&#43;08:00'/>
<meta name="twitter:title" content="RocketMq">
<meta name="twitter:description" content="1. RocketMq ç®€ä»‹ 1. ç‰¹ç‚¹ æ”¯æŒå‘å¸ƒ/è®¢é˜…ï¼ˆPub/Subï¼‰å’Œç‚¹å¯¹ç‚¹ï¼ˆP2Pï¼‰æ¶ˆæ¯æ¨¡å‹\nèƒ½å¤Ÿä¿è¯ä¸¥æ ¼çš„æ¶ˆæ¯é¡ºåºï¼Œåœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­å¯é çš„å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰å’Œä¸¥æ ¼çš„é¡ºåºä¼ é€’\n">
        
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
		<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avator_hu1060881492573662444.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">lexqinMike</a></h1>
            <h2 class="site-description">welcome to my blog, ä»£ç æ—  bugï¼Œå’–å•¡æ— é™ç»­ã€‚</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/CaiJimmy/hugo-theme-stack'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#1-rocketmq-ç®€ä»‹">1. RocketMq ç®€ä»‹</a>
      <ul>
        <li><a href="#1-ç‰¹ç‚¹">1. ç‰¹ç‚¹</a></li>
        <li><a href="#2-è¿è¡Œæ¶æ„">2. è¿è¡Œæ¶æ„</a></li>
        <li><a href="#3-åŸºç¡€æ¦‚å¿µ">3. åŸºç¡€æ¦‚å¿µ</a></li>
        <li><a href="#4-windows-å¼€å‘æ­å»º">4. windows å¼€å‘æ­å»º</a>
          <ul>
            <li><a href="#1-rocketmq">1. rocketMq</a></li>
            <li><a href="#2-rocketmq-dashboard">2. rocketmq-dashboard</a></li>
          </ul>
        </li>
        <li><a href="#5-æ£€æµ‹mqæœåŠ¡æ˜¯å¦æ­£å¸¸">5. æ£€æµ‹mqæœåŠ¡æ˜¯å¦æ­£å¸¸</a></li>
      </ul>
    </li>
    <li><a href="#2-é—®é¢˜">2. é—®é¢˜</a></li>
    <li><a href="#3-é¡ºåºæ¶ˆæ¯">3. é¡ºåºæ¶ˆæ¯</a>
      <ul>
        <li><a href="#1-æ¦‚å¿µæ€»ç»“">1. æ¦‚å¿µæ€»ç»“</a></li>
        <li><a href="#2-ä½¿ç”¨">2. ä½¿ç”¨</a>
          <ul>
            <li><a href="#1-é˜Ÿåˆ—é€‰æ‹©å™¨">1. é˜Ÿåˆ—é€‰æ‹©å™¨</a></li>
            <li><a href="#2-æ¶ˆæ¯ç”Ÿäº§è€…">2. æ¶ˆæ¯ç”Ÿäº§è€…</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#4-æ¶ˆæ¯æŠ•é€’ç­–ç•¥">4. æ¶ˆæ¯æŠ•é€’ç­–ç•¥</a>
      <ul>
        <li><a href="#1-ç”Ÿäº§è€…æŠ•é€’ç­–ç•¥">1. ç”Ÿäº§è€…æŠ•é€’ç­–ç•¥</a></li>
        <li><a href="#2-æ¶ˆè´¹è€…åˆ†é…é˜Ÿåˆ—">2. æ¶ˆè´¹è€…åˆ†é…é˜Ÿåˆ—</a></li>
      </ul>
    </li>
    <li><a href="#5--rocketmq-æ¶ˆæ¯å­˜å‚¨">5.  rocketMq æ¶ˆæ¯å­˜å‚¨</a></li>
    <li><a href="#6-æ¶ˆæ¯ä¿éšœ">6. æ¶ˆæ¯ä¿éšœ</a>
      <ul>
        <li><a href="#1-ç”Ÿäº§ç«¯ä¿éšœ">1. ç”Ÿäº§ç«¯ä¿éšœ</a></li>
        <li><a href="#2-æ¶ˆè´¹ç«¯ä¿éšœ">2. æ¶ˆè´¹ç«¯ä¿éšœ</a>
          <ul>
            <li><a href="#1-æ¶ˆæ¯ç¡®è®¤">1. æ¶ˆæ¯ç¡®è®¤</a></li>
            <li><a href="#2-æ¶ˆè´¹å¼‚å¸¸">2. <strong>æ¶ˆè´¹å¼‚å¸¸</strong></a></li>
          </ul>
        </li>
        <li><a href="#3-æ­»ä¿¡é˜Ÿåˆ—">3. æ­»ä¿¡é˜Ÿåˆ—</a></li>
      </ul>
    </li>
    <li><a href="#7-åº”ç”¨">7. åº”ç”¨</a>
      <ul>
        <li><a href="#1-spring-cloud-stream-æ•´åˆ">1. spring cloud stream æ•´åˆ</a>
          <ul>
            <li><a href="#1-ä¾èµ–">1. ä¾èµ–</a></li>
            <li><a href="#2-ç”Ÿäº§ç«¯é…ç½®æ–‡ä»¶">2. ç”Ÿäº§ç«¯é…ç½®æ–‡ä»¶</a></li>
            <li><a href="#3--æ¶ˆè´¹ç«¯é…ç½®æ–‡ä»¶">3.  æ¶ˆè´¹ç«¯é…ç½®æ–‡ä»¶</a></li>
          </ul>
        </li>
        <li><a href="#2-springboot-é›†æˆ-rocketmq">2. springboot é›†æˆ rocketMq</a>
          <ul>
            <li><a href="#1-çŸ¥è¯†ç‚¹-æ³›å‹æ–¹æ³•">1. çŸ¥è¯†ç‚¹: æ³›å‹æ–¹æ³•</a></li>
            <li><a href="#2-rocketmq-spring-boot-starter">2. rocketmq-spring-boot-starter</a>
              <ul>
                <li><a href="#1-å¼•å…¥ä¾èµ–">1. å¼•å…¥ä¾èµ–</a></li>
                <li><a href="#2-é…ç½®rocketmq">2. é…ç½®rocketMq</a></li>
                <li><a href="#3-æ„å»ºç”Ÿäº§è€…">3. æ„å»ºç”Ÿäº§è€…</a></li>
                <li><a href="#4-æ¶ˆè´¹è€…">4. æ¶ˆè´¹è€…</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#3-æ‰“è½¦æœåŠ¡">3. æ‰“è½¦æœåŠ¡</a>
          <ul>
            <li><a href="#1-è½¦è¾†è°ƒåº¦">1. è½¦è¾†è°ƒåº¦</a></li>
            <li><a href="#2-å¸æœºè‡ªåŠ¨æ¥å•">2. å¸æœºè‡ªåŠ¨æ¥å•</a></li>
            <li><a href="#3-ç”¨æˆ·ä¸‹è½¦">3. ç”¨æˆ·ä¸‹è½¦</a></li>
            <li><a href="#4-æ€»ä½“æµç¨‹">4. æ€»ä½“æµç¨‹</a></li>
          </ul>
        </li>
        <li><a href="#4--rocketmqpushconsumerlifecyclelistener-æ¥å£">4.  RocketMQPushConsumerLifecycleListener æ¥å£</a></li>
      </ul>
    </li>
    <li><a href="#8--ä»»åŠ¡">8.  ä»»åŠ¡</a></li>
    <li><a href="#9-rocketmq-çš„äº‹åŠ¡æ¶ˆæ¯">9. RocketMq çš„äº‹åŠ¡æ¶ˆæ¯</a></li>
    <li><a href="#10-æ¶ˆè´¹è€…é—²ç½®">10. æ¶ˆè´¹è€…é—²ç½®</a></li>
  </ul>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/rocketmq/" >
                RocketMq
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/rocketmq/">RocketMq</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jul 14, 2024</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 16 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="1-rocketmq-ç®€ä»‹">1. RocketMq ç®€ä»‹
</h1><h2 id="1-ç‰¹ç‚¹">1. ç‰¹ç‚¹
</h2><blockquote>
<ol>
<li>
<p>æ”¯æŒå‘å¸ƒ/è®¢é˜…ï¼ˆPub/Subï¼‰å’Œç‚¹å¯¹ç‚¹ï¼ˆP2Pï¼‰æ¶ˆæ¯æ¨¡å‹</p>
</li>
<li>
<p>èƒ½å¤Ÿä¿è¯ä¸¥æ ¼çš„æ¶ˆæ¯é¡ºåºï¼Œåœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­å¯é çš„å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰å’Œä¸¥æ ¼çš„é¡ºåºä¼ é€’</p>
</li>
<li>
<p>æä¾›ä¸°å¯Œçš„æ¶ˆæ¯æ‹‰å–æ¨¡å¼ï¼Œæ”¯æŒæ‹‰ï¼ˆpullï¼‰å’Œæ¨ï¼ˆpushï¼‰ä¸¤ç§æ¶ˆæ¯æ¨¡å¼</p>
<ol>
<li>
<p>æ¨æ¨¡å¼ï¼šåœ¨æ¨æ¨¡å¼ä¸‹ï¼Œ==æ¶ˆæ¯ä»æœåŠ¡å™¨â€œæ¨åŠ¨â€åˆ°æ¶ˆè´¹è€…==ã€‚è¿™æ„å‘³ç€ä¸€æ—¦æœ‰æ–°çš„æ¶ˆæ¯è¿›å…¥æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨éƒ½ä¼šå°†å®ƒä»¬æ¨é€ç»™æ¶ˆè´¹è€…ï¼Œæ¶ˆè´¹è€…åªéœ€è¦æ¥æ”¶å’Œå¤„ç†æ¶ˆæ¯å³å¯ã€‚è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ¶ˆè´¹è€…è¾ƒä¸ºè¢«åŠ¨ï¼Œä¸»è¦å…³æ³¨ç‚¹æ˜¯å¦‚ä½•å¤„ç†æ¨é€è¿‡æ¥çš„æ¶ˆæ¯ï¼Œé€‚åˆæ¶ˆæ¯å¤„ç†é€Ÿåº¦è¾ƒå¿«ï¼Œå¯¹å®æ—¶æ€§è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ã€‚</p>
<p>æ‹‰æ¨¡å¼ï¼šåœ¨æ‹‰æ¨¡å¼ä¸‹ï¼Œ==æ¶ˆè´¹è€…ä»æœåŠ¡å™¨â€œæ‹‰å–â€æ¶ˆæ¯==ã€‚è¿™æ ·ï¼Œæ¶ˆè´¹è€…å¯ä»¥å†³å®šä½•æ—¶è·å–æ¶ˆæ¯ï¼Œå¹¶å¯æ ¹æ®è‡ªèº«éœ€æ±‚å’Œèƒ½åŠ›å»ä¸»åŠ¨è·å–æ¶ˆæ¯ï¼Œå› æ­¤å¯ä»¥æ›´å¥½åœ°æ§åˆ¶æ¶ˆæ¯å¤„ç†çš„é€Ÿåº¦å’ŒèŠ‚å¥ã€‚å®ƒé€‚åˆå¤„ç†çš„æ¶ˆæ¯å¹¶ä¸é‚£ä¹ˆç´§æ€¥ï¼Œå…è®¸æœ‰ä¸€å®šå»¶è¿Ÿçš„åœºæ™¯ï¼Œæˆ–è€…å¤„ç†èƒ½åŠ›æœ‰é™éœ€è¦è‡ªæˆ‘æ§åˆ¶æ‹‰å–é€Ÿåº¦çš„åœºæ™¯ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒRocketMQ==é»˜è®¤é‡‡ç”¨çš„æ˜¯æ¨æ¨¡å¼è¿›è¡Œæ¶ˆæ¯çš„æ¶ˆè´¹==ï¼Œä½†==å®è´¨ä¸Šå…¶å†…éƒ¨å¯¹äºæ¶ˆæ¯çš„è·å–å…¶å®æ˜¯æ‹‰æ¨¡å¼==ï¼ŒåŒºåˆ«åœ¨äºRocketMQçš„==å®¢æˆ·ç«¯å°è£…äº†è¯¦å°½çš„æ‹‰å–è°ƒç”¨ï¼Œä½¿å¾—å¯¹äºç»ˆç«¯ä½¿ç”¨è€…æ¥è¯´å±•ç¤ºå‡ºçš„æ˜¯æ¨é€æ¨¡å¼==ã€‚</p>
</li>
</ol>
</li>
<li>
<p>å•ä¸€é˜Ÿåˆ—ç™¾ä¸‡æ¶ˆæ¯çš„å †ç§¯èƒ½åŠ›ï¼Œäº¿çº§æ¶ˆæ¯å †ç§¯èƒ½åŠ›</p>
</li>
<li>
<p>æ”¯æŒå¤šç§æ¶ˆæ¯åè®®ï¼Œå¦‚ JMSã€MQTT ç­‰</p>
</li>
<li>
<p>åˆ†å¸ƒå¼é«˜å¯ç”¨çš„éƒ¨ç½²æ¶æ„,æ»¡è¶³è‡³å°‘ä¸€æ¬¡æ¶ˆæ¯ä¼ é€’è¯­ä¹‰</p>
</li>
</ol>
</blockquote>
<p>åŸç†:</p>
<blockquote>
<p><a class="link" href="https://www.jianshu.com/p/2838890f3284"  target="_blank" rel="noopener"
    >https://www.jianshu.com/p/2838890f3284</a></p>
</blockquote>
<p>ä¸»è¦ä¼˜åŠ¿</p>
<blockquote>
<ul>
<li>
<p>æ”¯æŒ==äº‹åŠ¡å‹æ¶ˆæ¯==ï¼ˆæ¶ˆæ¯å‘é€å’Œ DB æ“ä½œä¿æŒä¸¤æ–¹çš„æœ€ç»ˆä¸€è‡´æ€§ï¼ŒRabbitMQ å’Œ Kafka ä¸æ”¯æŒï¼‰</p>
</li>
<li>
<p>æ”¯æŒç»“åˆ RocketMQ çš„å¤šä¸ªç³»ç»Ÿä¹‹é—´==æ•°æ®æœ€ç»ˆä¸€è‡´æ€§==ï¼ˆ==å¤šæ–¹äº‹åŠ¡==ï¼ŒäºŒæ–¹äº‹åŠ¡æ˜¯å‰æï¼‰</p>
</li>
<li>
<p>æ”¯æŒ 18 ä¸ªçº§åˆ«çš„==å»¶è¿Ÿæ¶ˆæ¯==ï¼ˆRabbitMQ å’Œ Kafka ä¸æ”¯æŒï¼‰</p>
</li>
<li>
<p>æ”¯æŒ==æŒ‡å®šæ¬¡æ•°å’Œæ—¶é—´é—´éš”çš„å¤±è´¥æ¶ˆæ¯é‡å‘==ï¼ˆKafka ä¸æ”¯æŒï¼ŒRabbitMQ éœ€è¦æ‰‹åŠ¨ç¡®è®¤ï¼‰</p>
</li>
<li>
<p>æ”¯æŒ ==Consumer ç«¯ Tag è¿‡æ»¤==ï¼Œå‡å°‘ä¸å¿…è¦çš„ç½‘ç»œä¼ è¾“ï¼ˆRabbitMQ å’Œ Kafka ä¸æ”¯æŒï¼‰</p>
</li>
<li>
<p>==æ”¯æŒé‡å¤æ¶ˆè´¹==ï¼ˆRabbitMQ ä¸æ”¯æŒï¼ŒKafka æ”¯æŒï¼‰</p>
</li>
</ul>
</blockquote>
<h2 id="2-è¿è¡Œæ¶æ„">2. è¿è¡Œæ¶æ„
</h2><blockquote>
<p>ä¸€ä¸ªæ­£å¸¸å·¥ä½œçš„RocketMQåŒ…æ‹¬å››ä¸ªéƒ¨åˆ†ã€‚</p>
<p>NameServer ï¼šåŸºäºé«˜å¯ç”¨è®¾è®¡äº§ç”Ÿçš„ï¼Œç”¨äºæœåŠ¡å‘ç°å’Œè·¯ç”±ã€‚æ­£å¼åº”ç”¨æ—¶é€šå¸¸é‡‡ç”¨é›†ç¾¤éƒ¨ç½²ã€‚==å°±ç›¸å½“äºä¸ç¥–å†Œä¸­å¿ƒ==,  ==NameServerä¹‹é—´æ²¡æœ‰é€šä¿¡==,   ==broker éœ€è¦åˆ° æ‰€æœ‰çš„nameServerä¸Šå»æ³¨å†Œ==</p>
<p>Brokerï¼šå®ç°==é˜Ÿåˆ—æœºåˆ¶==ï¼Œè´Ÿè´£æ¶ˆæ¯å­˜å‚¨å’Œè½¬å‘ã€‚æ­£å¼åº”ç”¨æ—¶ä¹Ÿé‡‡ç”¨é›†ç¾¤éƒ¨ç½². ä¹Ÿå°±æ˜¯==æ¶ˆæ¯å­˜å‚¨ä¸­å¿ƒ==, å®ƒè¿˜==å­˜å‚¨ä¸æ¶ˆæ¯ç›¸å…³çš„å…ƒæ•°æ®==, Broker æœ‰ Master å’Œ Slave ä¸¤ç§ç±»å‹ï¼ŒMaster æ—¢å¯ä»¥å†™åˆå¯ä»¥è¯»ï¼ŒSlaveä¸å¯ä»¥å†™åªå¯ä»¥è¯»ã€‚</p>
<p>Producerï¼šæ¶ˆæ¯ç”Ÿäº§è€…ï¼Œç”Ÿæˆæ¶ˆæ¯å¹¶å‘é€åˆ°RocketMQä¸­ï¼Œç”Ÿäº§è€…é€šå¸¸æ˜¯æˆ‘ä»¬è‡ªå·±å®ç°çš„åº”ç”¨ç¨‹åºã€‚</p>
<p>Consumerï¼šæ¶ˆæ¯æ¶ˆè´¹è€…ï¼Œä»RocketMQä¸­æ¥æ”¶æ¶ˆæ¯å¹¶è¿›è¡Œä¸šåŠ¡å¤„ç†ã€‚è¿™éƒ¨åˆ†ä¹Ÿé€šå¸¸æ˜¯æˆ‘ä»¬è‡ªå·±å®ç°çš„ã€‚</p>
</blockquote>
<p><img src="/image-20210604094345170.png"
	
	
	
	loading="lazy"
	
		alt="image-20210604094345170"
	
	
></p>
<p>è¿è½¬æµç¨‹</p>
<p><img src="/p/rocketmq/images/image-20211211104734307.png"
	width="737"
	height="443"
	
	loading="lazy"
	
		alt="image-20211211104734307"
	
	
		class="gallery-image" 
		data-flex-grow="166"
		data-flex-basis="399px"
	
></p>
<pre><code class="language-properties">1. NameServerå¯åŠ¨
2. Brokerå¯åŠ¨å‘NameServeræ³¨å†Œ
3. ç”Ÿäº§è€…å†å‘é€æŸä¸ªä¸»é¢˜çš„æ¶ˆæ¯å‰ å…ˆä» NameServer è·å–BrokeræœåŠ¡å™¨åœ°å€åˆ—è¡¨(å¯èƒ½å›æ˜¯é›†ç¾¤), ç„¶åæ ¹æ®è´Ÿè½½å‡è¡¡ç®—æ³•, ä»åˆ—è¡¨æ±‡æ€»é€‰æ‹©ä¸€å°Broker è¿›è¡Œæ¶ˆæ¯å‘é€
4. NameServer ä¸æ¯å°broker æœåŠ¡å™¨ä¿æŒé•¿é“¾æ¥, æ¯éš”30s ç›‘æµ‹æ˜¯å¦å­˜æ´», å¦‚æœæ£€æµ‹åˆ°
Broker å®•æœºï¼ˆä½¿ç”¨å¿ƒè·³æœºåˆ¶ï¼Œ å¦‚æœæ£€æµ‹è¶…è¿‡120Sï¼‰ï¼Œåˆ™ä»è·¯ç”±æ³¨å†Œè¡¨ä¸­å°†å…¶ç§»é™¤ã€‚
5. æ¶ˆè´¹è€…åœ¨è®¢é˜…æŸä¸ªä¸»é¢˜çš„æ¶ˆæ¯ä¹‹å‰ä» NamerServer è·å– Broker æœåŠ¡å™¨åœ°å€åˆ—è¡¨ï¼ˆæœ‰å¯èƒ½æ˜¯é›†ç¾¤ï¼‰ï¼Œä½†æ˜¯æ¶ˆè´¹è€…é€‰æ‹©ä» Broker ä¸­ è®¢é˜…æ¶ˆæ¯ï¼Œè®¢é˜…è§„åˆ™ç”± Broker é…ç½®å†³å®š
</code></pre>
<p>Message -&gt; è¦ä¼ è¾“çš„ä¿¡æ¯</p>
<p>Topic -&gt; ä¸€æ¡æ¶ˆæ¯å¿…é¡»è¦æœ‰ä¸€ä¸ªTopic, ==å¯ä»¥çœ‹åšæ˜¯ä½ çš„ä¿¡ä»¶è¦é‚®å¯„çš„åœ°å€==</p>
<p>Tag -&gt; ä¸€æ¡æ¶ˆæ¯ä¹Ÿå¯ä»¥æ‹¥æœ‰ä¸€ä¸ª==å¯é€‰çš„æ ‡ç­¾ï¼ˆTagï¼‰å’Œé¢å¤–çš„é”®å€¼å¯¹==ï¼Œå®ƒä»¬å¯ä»¥ç”¨äºè®¾ç½®</p>
<p>==ä¸€ä¸ªä¸šåŠ¡ key å¹¶åœ¨ Broker ä¸ŠæŸ¥æ‰¾æ­¤æ¶ˆæ¯==ä»¥ä¾¿åœ¨å¼€å‘æœŸé—´æŸ¥æ‰¾é—®é¢˜ã€‚</p>
<h2 id="3-åŸºç¡€æ¦‚å¿µ">3. åŸºç¡€æ¦‚å¿µ
</h2><ol>
<li>
<p>Producer Group:  åªæ˜¯ä¸€ä¸ªæ¦‚å¿µæ€§çš„, é…ä¸é…éƒ½æ²¡æœ‰ä»€ä¹ˆå½±å“</p>
<blockquote>
<p>ç”Ÿäº§è€…ç»„ï¼šæ˜¯ä¸€ç±»ç”Ÿäº§è€…çš„é›†åˆï¼Œé€šå¸¸å‘é€åŒä¸€ç±»æ¶ˆæ¯å¹¶ä¸”å‘é€é€»è¾‘ä¸€è‡´</p>
</blockquote>
</li>
<li>
<p>Producer:</p>
<blockquote>
<p>ä¸‰ç§æ¶ˆæ¯å‘é€æ–¹å¼</p>
<p>1: åŒæ­¥</p>
<p>2: å¼‚æ­¥</p>
<p>3: å•å‘å‘é€</p>
</blockquote>
</li>
<li>
<p>Consumer Group</p>
<blockquote>
<p>æ¶ˆè´¹è€…ç»„ï¼šæ˜¯ä¸€ç±»æ¶ˆè´¹è€…çš„é›†åˆï¼Œé€šå¸¸æ¶ˆè´¹åŒä¸€ç±»æ¶ˆæ¯å¹¶ä¸”æ¶ˆè´¹é€»è¾‘ä¸€è‡´</p>
</blockquote>
</li>
<li>
<p>Consumer</p>
<blockquote>
<p>ä¸¤ç§æ¶ˆè´¹æ¨¡å¼:</p>
<ol>
<li>æ‹‰å–å‹</li>
<li>æ¨é€å‹: å®é™…ä¸Šä¹Ÿæ˜¯æ‹‰å–æ¶ˆæ¯, ä½†æ˜¯å¯¹æ‹‰å–é€»è¾‘è¿›è¡Œäº†å°è£…, å°†æ¶ˆæ¯è¾¾åˆ°æ—¶æ‰§è¡Œçš„å›è°ƒæ¥å£ç•™ç»™ç”¨æˆ·æ¥å®ç°</li>
</ol>
</blockquote>
</li>
<li>
<p>Broker (å­˜å‚¨æ¶ˆæ¯);</p>
<blockquote>
<p>æ¯ä¸ªBrokerä¸Name Serveré›†ç¾¤ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹å»ºç«‹é•¿è¿æ¥ï¼Œå®šæ—¶(æ¯éš”30s)==æ³¨å†ŒTopicä¿¡æ¯åˆ°æ‰€æœ‰Name Server==ã€‚Name Serverå®šæ—¶(æ¯éš”10s)æ‰«ææ‰€æœ‰å­˜æ´»brokerçš„è¿æ¥ï¼Œå¦‚æœName Serverè¶…è¿‡2åˆ†é’Ÿæ²¡æœ‰æ”¶åˆ°å¿ƒè·³ï¼Œåˆ™Name Serveræ–­å¼€ä¸Brokerçš„è¿æ¥ã€‚</p>
<p><img src="/p/rocketmq/images/image-20240509173328871.png"
	width="1383"
	height="794"
	
	loading="lazy"
	
		alt="image-20240509173328871"
	
	
		class="gallery-image" 
		data-flex-grow="174"
		data-flex-basis="418px"
	
></p>
</blockquote>
</li>
<li>
<p>NameServer</p>
<blockquote>
<p>ä½œç”¨å’Œzookeeperç±»ä¼¼, ç”¨æ¥ä¿å­˜brokerç›¸å…³å…ƒç´ , å¹¶ç»™producer å’Œcomsumer æŸ¥æ‰¾broker æ¶ˆæ¯, ==Producer åœ¨å‘é€æ¶ˆæ¯å‰ä¼šæ ¹æ® Topic åˆ° NameServer è·å–åˆ° Broker çš„è·¯ç”±ä¿¡æ¯ï¼ŒConsumer ä¹Ÿä¼šå®šæ—¶è·å– Topic çš„è·¯ç”±ä¿¡æ¯==ã€‚</p>
<p>name-serverå……å½“==è·¯ç”±æ¶ˆæ¯çš„æä¾›è€…==ã€‚ç”Ÿäº§è€…æˆ–æ¶ˆè´¹è€…èƒ½å¤Ÿé€šè¿‡name-serveræŸ¥æ‰¾å„ä¸»é¢˜ç›¸åº”çš„ Broker IP åˆ—è¡¨ã€‚å¤šä¸ª Namesrv å®ä¾‹ç»„æˆé›†ç¾¤ï¼Œä½†ç›¸äº’ç‹¬ç«‹ï¼Œæ²¡æœ‰ä¿¡æ¯äº¤æ¢</p>
</blockquote>
</li>
<li>
<p>topic æ¶ˆæ¯ä¸»é¢˜ (==ç†è§£ä¸ºrebbit çš„ exchange==); å¯ä»¥çœ‹åšæ¶ˆæ¯çš„è§„ç±»</p>
</li>
<li>
<p>tag  æ¶ˆè´¹æ ‡ç­¾;  (==ç†è§£ä¸º rabbit çš„ routing key==)</p>
<blockquote>
<p>æ ‡ç­¾, Topicçš„äºŒçº§åˆ†ç±», å¯ä»¥ç†è§£ä¸º==æ¶ˆæ¯é˜Ÿåˆ—==, ==ä¸€ä¸ªTopic å¯ä»¥è®¾ç½®å¤šä¸ªTag==, å‘é€æ¶ˆæ¯æ—¶æ‰§è¡Œè¯¥æ¶ˆæ¯çš„Topic, RockerMq ==ä¼šè½®è¯¢è¯¥Topic ä¸‹æ‰€æœ‰çš„é˜Ÿåˆ—å°†æ¶ˆæ¯å‘å‡ºå»==</p>
</blockquote>
</li>
<li>
<p>message queue æ¶ˆæ¯é˜Ÿåˆ—&ndash;&gt; ä¸»é¢˜è¢«åˆ’åˆ†ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªå­ä¸»é¢˜. å°±æ˜¯æ¶ˆæ¯é˜Ÿåˆ—</p>
</li>
</ol>
<p>Topic å’Œ Tags ä½¿ç”¨ç¤ºä¾‹</p>
<blockquote>
<p>ä»¥å¤©çŒ«äº¤æ˜“å¹³å°ä¸ºä¾‹ï¼Œè®¢å•æ¶ˆæ¯ï¼Œæ”¯ä»˜æ¶ˆæ¯å±äºä¸åŒä¸šåŠ¡ç±»å‹çš„æ¶ˆæ¯ï¼Œåˆ†åˆ«åˆ›å»º Topic_Order å’Œ Topic_Payï¼Œå…¶ä¸­è®¢å•æ¶ˆæ¯æ ¹æ®å•†å“å“ç±»ä»¥ä¸åŒçš„ Tag å†è¿›è¡Œç»†åˆ†ï¼Œå¦‚ç”µå™¨ç±»ã€ç”·è£…ç±»ã€å¥³è£…ç±»ã€åŒ–å¦†å“ç±»ï¼Œæœ€åä»–ä»¬éƒ½è¢«å„ä¸ªä¸åŒçš„ç³»ç»Ÿæ‰€æ¥æ”¶ã€‚</p>
</blockquote>
<p><img src="/topic-tags.png"
	
	
	
	loading="lazy"
	
		alt="topic-tags"
	
	
></p>
<h2 id="4-windows-å¼€å‘æ­å»º">4. windows å¼€å‘æ­å»º
</h2><h3 id="1-rocketmq">1. rocketMq
</h3><blockquote>
<p>å‚è€ƒèµ„æ–™ <a class="link" href="https://blog.csdn.net/zxl646801924/article/details/105637278"  target="_blank" rel="noopener"
    >https://blog.csdn.net/zxl646801924/article/details/105637278</a></p>
</blockquote>
<p>æ³¨æ„: ==javaç¯å¢ƒä¸º1.8==</p>
<p>nameserver å¯åŠ¨</p>
<pre><code>start mqnamesrv.cmd
</code></pre>
<p>brokerå¯åŠ¨</p>
<pre><code>start mqbroker.cmd -n 127.0.0.1:9876 autoCreateTopicEnable=true
</code></pre>
<p>å‘é€æ¶ˆæ¯å¤±è´¥, ç©ºé—´ä¸è¶³, ä¿®æ”¹å¯åŠ¨è„šæœ¬</p>
<blockquote>
<p>å‚è€ƒèµ„æ–™ <a class="link" href="https://blog.csdn.net/muriyue6/article/details/130607492"  target="_blank" rel="noopener"
    >https://blog.csdn.net/muriyue6/article/details/130607492</a></p>
</blockquote>
<pre><code>runbroker.shæ–‡ä»¶æ·»åŠ 
set &quot;JAVA_OPT=%JAVA_OPT% -server -Xms512m -Xmx512m -Xmn128m -Drocketmq.broker.diskSpaceWarningLevelRatio=0.99&quot;ï¼Œä½¿ç£ç›˜ä½¿ç”¨è¶…è¿‡99%å†æŠ¥é”™ï¼Œæ ¹æœ¬çš„è§£å†³åŠæ³•æ˜¯ä¿è¯ç£ç›˜ç©ºé—´æ°¸è¿œä¸è¶…è¿‡90%

</code></pre>
<p>éªŒè¯MqæœåŠ¡</p>
<ol>
<li>å¯åŠ¨consumer</li>
</ol>
<pre><code>set NAMESRV_ADDR=127.0.0.1:9876
tools.cmd org.apache.rocketmq.example.quickstart.Consumer
</code></pre>
<ol start="2">
<li>å¯åŠ¨producer</li>
</ol>
<pre><code>set NAMESRV_ADDR=127.0.0.1:9876
tools.cmd org.apache.rocketmq.example.quickstart.Producer
</code></pre>
<h3 id="2-rocketmq-dashboard">2. rocketmq-dashboard
</h3><blockquote>
<p><a class="link" href="https://github.com/apache/rocketmq-dashboard"  target="_blank" rel="noopener"
    >https://github.com/apache/rocketmq-dashboard</a></p>
</blockquote>
<pre><code>mvn clean package -Dmaven.test.skip=true
java -jar target/rocketmq-dashboard-1.0.1-SNAPSHOT.jar
</code></pre>
<h2 id="5-æ£€æµ‹mqæœåŠ¡æ˜¯å¦æ­£å¸¸">5. æ£€æµ‹mqæœåŠ¡æ˜¯å¦æ­£å¸¸
</h2><pre><code>&gt; export NAMESRV_ADDR=localhost:9876
&gt; sh bin/tools.sh org.apache.rocketmq.example.quickstart.Producer
 SendResult [sendStatus=SEND_OK, msgId= ...
</code></pre>
<p>å¦‚ä¸‹æ‰€ç¤ºå®˜æ–¹æä¾›è¿™ä¸ªä¾‹å­å±äºç”Ÿäº§è€…ï¼Œ==ç”¨äºå‘é€æ¶ˆæ¯ï¼Œè¿è¡Œä¹‹åä¼šå‘é€å¤§é‡çš„æ¶ˆæ¯==ï¼Œä¹‹åå°±ä¼šé€€å‡º</p>
<p>æ¥æ”¶æ¶ˆæ¯</p>
<pre><code> sh bin/tools.sh org.apache.rocketmq.example.quickstart.Consumer
 ConsumeMessageThread_%d Receive New Messages: [MessageExt...
</code></pre>
<p>ä¸Šé¢çš„æ¶ˆæ¯å‘é€å®Œæ¯•ä¹‹åå°±ä¼šé€€å‡ºï¼Œåœ¨åŒä¸€çª—å£ä¸­å¯ä»¥ä½¿ç”¨æ¶ˆè´¹è€…ç±»æ¥è¿›è¡Œæ¥æ”¶æ¶ˆæ¯, æ˜¯å¤šçº¿ç¨‹çš„æ¶ˆè´¹</p>
<h1 id="2-é—®é¢˜">2. é—®é¢˜
</h1><ul>
<li>
<p><input disabled="" type="checkbox"> rocketMq å‘é€æ¶ˆæ¯çš„æ—¶å€™, é»˜è®¤çš„é˜Ÿåˆ—æ˜¯ä»€ä¹ˆ? ä¸éœ€è¦å•ç‹¬åˆ›å»ºå’ŒæŒ‡å®šå—?</p>
<ul>
<li><input disabled="" type="checkbox"> é»˜è®¤æ˜¯å››ä¸ª</li>
</ul>
</li>
<li>
<p><input disabled="" type="checkbox"> rocketMq dashboard è¦å¦‚ä½•ä½¿ç”¨?</p>
</li>
<li>
<p><input disabled="" type="checkbox"> rocketMq çš„==æ¶ˆè´¹ç­–ç•¥ä¸å¯ä»¥éšæ„æ›´æ”¹, å¯èƒ½ä¼šé€ æˆé‡å¤æ¶ˆè´¹å’Œ é˜Ÿåˆ—æ²¡æœ‰æ¶ˆè´¹è€…æ¶ˆè´¹==</p>
<ul>
<li><input disabled="" type="checkbox"> ä¸ºä»€ä¹ˆ?</li>
</ul>
</li>
<li>
<p><input disabled="" type="checkbox"> rocketMq çš„é¡ºåºæ¶ˆæ¯æ˜¯æ€ä¹ˆå®ç°çš„? é¡ºåºæ¶ˆæ¯æœ‰å‡ ç§ç±»å‹</p>
</li>
<li>
<p><input disabled="" type="checkbox"> rocketMq æœ‰å“ªäº›æ¶ˆæ¯æŠ•é€’ç­–ç•¥</p>
</li>
</ul>
<h1 id="3-é¡ºåºæ¶ˆæ¯">3. é¡ºåºæ¶ˆæ¯
</h1><h2 id="1-æ¦‚å¿µæ€»ç»“">1. æ¦‚å¿µæ€»ç»“
</h2><p>==rocketMq  é‡Œé¢çš„å±€éƒ¨é¡ºåº, ä¾é çš„æ˜¯broker-queue ä¸­çš„åˆ†æ®µé”å®ç°çš„, queue ä¸­çš„æ¶ˆæ¯ä¸€å®šæ˜¯å…ˆå…¥å…ˆå‡ºçš„==</p>
<p>å±€éƒ¨é¡ºåºæœ‰ä¸€ä¸ªå¾ˆå…³é”®çš„ç‚¹ï¼Œåœ¨==ä¸€ä¸ªæ¶ˆè´¹è€…é›†ç¾¤çš„æƒ…å†µä¸‹==</p>
<ol>
<li>
<p>æ¶ˆè´¹è€…1å…ˆå»Queueæ‹¿æ¶ˆæ¯ï¼Œå®ƒæ‹¿åˆ°äº†åŒ—äº¬è®¢å•1ï¼Œå®ƒæ‹¿å®Œåï¼Œ</p>
</li>
<li>
<p>æ¶ˆè´¹è€…2å»queueæ‹¿åˆ°çš„æ˜¯ åŒ—äº¬è®¢å•2ã€‚</p>
</li>
<li>
<p>æ‹¿çš„é¡ºåºæ˜¯æ²¡æ¯›ç—…äº†ï¼Œ==ä½†å…³é”®æ˜¯å…ˆæ‹¿åˆ°ä¸ä»£è¡¨å…ˆæ¶ˆè´¹å®Œå®ƒ==ã€‚</p>
</li>
<li>
<p>ä¼šå­˜åœ¨è™½ç„¶ä½ æ¶ˆè´¹è€…1å…ˆæ‹¿åˆ°åŒ—äº¬è®¢å• ä½†ç”±äºç½‘ç»œç­‰åŸå› ï¼Œæ¶ˆè´¹è€…2æ¯”ä½ çœŸæ­£çš„å…ˆæ¶ˆè´¹æ¶ˆæ¯ã€‚è¿™æ˜¯ä¸æ˜¯å¾ˆå°´å°¬äº†ã€‚</p>
</li>
</ol>
<p><strong>å®é™…ä¸Š</strong></p>
<p>==Brokeré‡‡ç”¨çš„æ˜¯åˆ†æ®µé”ï¼Œå®ƒä¸æ˜¯é”æ•´ä¸ªBrokerè€Œæ˜¯é”é‡Œé¢çš„å•ä¸ªQueue==ï¼Œå› ä¸ºåªè¦é”å•ä¸ª Queueå°±å¯ä»¥ä¿è¯å±€éƒ¨é¡ºåºæ¶ˆè´¹äº†ã€‚</p>
<p>æ‰€ä»¥æœ€ç»ˆçš„æ¶ˆè´¹è€…è¿™è¾¹çš„é€»è¾‘å°±æ˜¯</p>
<ol>
<li>
<p>æ¶ˆè´¹è€…1å»Queueæ‹¿ åŒ—äº¬è®¢å•1ï¼Œ==å®ƒå°±é”ä½äº†æ•´ä¸ªQueueï¼Œåªæœ‰å®ƒæ¶ˆè´¹å®Œæˆå¹¶è¿”å›æˆåŠŸåï¼Œè¿™ä¸ªé”æ‰ä¼šé‡Šæ”¾==ã€‚</p>
</li>
<li>
<p>ç„¶åä¸‹ä¸€ä¸ªæ¶ˆè´¹è€…å»æ‹¿åˆ° åŒ—äº¬è®¢å•2 åŒæ ·é”ä½å½“å‰Queue,è¿™æ ·çš„ä¸€ä¸ªè¿‡ç¨‹æ¥çœŸæ­£ä¿è¯å¯¹åŒä¸€ä¸ª Queueèƒ½å¤ŸçœŸæ­£æ„ä¹‰ä¸Šçš„é¡ºåºæ¶ˆè´¹ï¼Œè€Œä¸ä»…ä»…æ˜¯é¡ºåºå–å‡º</p>
</li>
</ol>
<p>æ³¨æ„äº‹é¡¹</p>
<ul>
<li>
<p>é¡ºåºæ¶ˆæ¯æš‚ä¸æ”¯æŒå¹¿æ’­æ¨¡å¼ã€‚</p>
</li>
<li>
<p>é¡ºåºæ¶ˆæ¯ä¸æ”¯æŒå¼‚æ­¥å‘é€æ–¹å¼ï¼Œå¦åˆ™å°†æ— æ³•ä¸¥æ ¼ä¿è¯é¡ºåºã€‚</p>
</li>
<li>
<p>==å»ºè®®åŒä¸€ä¸ª Group ID åªå¯¹åº”ä¸€ç§ç±»å‹çš„ Topicï¼Œå³ä¸åŒæ—¶ç”¨äºé¡ºåºæ¶ˆæ¯å’Œæ— åºæ¶ˆæ¯çš„æ”¶å‘==ã€‚</p>
</li>
<li>
<p>å¯¹äºå…¨å±€é¡ºåºæ¶ˆæ¯ï¼Œå»ºè®®åˆ›å»ºbrokerä¸ªæ•° &gt;=2ã€‚</p>
</li>
</ul>
<h2 id="2-ä½¿ç”¨">2. ä½¿ç”¨
</h2><h3 id="1-é˜Ÿåˆ—é€‰æ‹©å™¨">1. é˜Ÿåˆ—é€‰æ‹©å™¨
</h3><pre><code class="language-java">public class SelectorFactory {
    /**
    * å·¥å‚æ¨¡å¼è·å–MessageQueueSelector
    *
    * @param value
    * @return
    */
	public static MessageQueueSelector getMessageQueueSelector(String value) {
        //å¦‚æœvalueä¸ä¸ºç©ºä½¿ç”¨hashé€‰æ‹©å™¨
        if (StringUtils.isNotEmpty(value)) {
        return new SelectMessageQueueByHash();
        }
        //å¦‚æœvalueä¸ºç©ºä½¿ç”¨éšæœºé€‰æ‹©å™¨
        return new SelectMessageQueueByRandom();
    }
}
</code></pre>
<h3 id="2-æ¶ˆæ¯ç”Ÿäº§è€…">2. æ¶ˆæ¯ç”Ÿäº§è€…
</h3><pre><code class="language-java">@Component
public class MQProducer {

    @Autowired
    DefaultMQProducer defaultMQProducer;

    /**
     * åŒæ­¥å‘é€æ¶ˆæ¯
     *
     * @param taxiBO
     */
    public void send(TaxiBO taxiBO) {
        if (null == taxiBO) {
            return;
        }
        SendResult sendResult = null;
        try {
//è·å–æ¶ˆæ¯å¯¹è±¡
            Message message =
                    RocketMQHelper.buildMessage(DispatchConstant.SEQ_TOPIC, taxiBO);
//æ ¹æ®åŒºåŸŸç¼–ç è·å–é˜Ÿåˆ—é€‰æ‹©å™¨
            MessageQueueSelector selector =
                    SelectorFactory.getMessageQueueSelector(taxiBO.getAreaCode());
//å‘é€åŒæ­¥æ¶ˆæ¯
            sendResult = defaultMQProducer.send(message, selector,
                    taxiBO.getAreaCode(), 10000);
        } catch (Exception e) {
            e.printStackTrace();
        }
        if (null != sendResult) {
            System.out.println(sendResult.toString());
        }
    }
}
</code></pre>
<h1 id="4-æ¶ˆæ¯æŠ•é€’ç­–ç•¥">4. æ¶ˆæ¯æŠ•é€’ç­–ç•¥
</h1><p>==ä¸€ä¸ªé˜Ÿåˆ—åªèƒ½è¢«ä¸€ä¸ªæ¶ˆè´¹è€…è®¢é˜… (å¯ä»¥ä¿è¯ä¸è¢«é‡å¤æ¶ˆè´¹), ä¸€ä¸ªæ¶ˆè´¹è€…å¯ä»¥è®¢é˜…å¤šä¸ªé˜Ÿåˆ—==</p>
<blockquote>
<p>é›†ç¾¤æ¶ˆè´¹ clustering (é»˜è®¤); å°±æ˜¯åˆ†ç»„</p>
<pre><code>æ¨¡å¼ä¸‹ä¸€ä¸ªæ¶ˆè´¹è€…é›†ç¾¤å…±åŒæ¶ˆè´¹ä¸€ä¸ªä¸»é¢˜çš„å¤šä¸ªé˜Ÿåˆ—ï¼Œä¸€ä¸ªé˜Ÿåˆ—åªä¼šè¢«
ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œå¦‚æœæŸä¸ªæ¶ˆè´¹è€…æŒ‚æ‰ï¼Œåˆ†ç»„å†…å…¶å®ƒæ¶ˆè´¹è€…ä¼šæ¥æ›¿æŒ‚æ‰çš„æ¶ˆè´¹è€…ç»§ç»­æ¶ˆè´¹
</code></pre>
<p>å¹¿æ’­æ¶ˆè´¹ broadcasting</p>
<pre><code>å‘ç»™æ¶ˆè´¹è€…ç»„ä¸­çš„æ¯ä¸€ä¸ªæ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹
</code></pre>
</blockquote>
<p>==commitlog æœ‰æ–‡ä»¶è¿‡æœŸæ—¶é—´, é»˜è®¤æ˜¯72å°æ—¶, å½“è¶…è¿‡è¿™ä¸ªæ—¶é—´æ–‡ä»¶æ²¡æœ‰ä»»ä½•æ²¡æœ‰æ›´æ–°çš„è¯, æ–‡ä»¶ä¼šè¢«åˆ é™¤, æ— æ³•æ‰¾å›==</p>
<p>==è¶…è¿‡è¶…æ—¶æ—¶é—´, æ¶ˆæ¯å‘é€å¤±è´¥çš„, æ˜¯ä¸ä¼šè¿›è¡Œé‡è¯•çš„==</p>
<p>==é›†ç¾¤éƒ¨ç½²éœ€è¦ç¦æ­¢è‡ªåŠ¨åˆ›å»ºä¸»é¢˜==</p>
<p>æ¶ˆæ¯é‡è¯•</p>
<ol>
<li>rabbitMq æ˜¯ä¼šå›åˆ°é˜Ÿåˆ—çš„å¤´éƒ¨, é‡æ–°å‘é€</li>
<li>rocketMq åˆ™æ˜¯ä¼šæ–°å¼€ä¸€ä¸ªæ–°çš„é˜Ÿåˆ—, å·²å½“å‰æ¶ˆè´¹ç»„ä¸ºå•ä½, ä¸å…·ä½“çš„ä¸»é¢˜æ— å…³, ä¸ä¼šç«‹é©¬é‡è¯•, å¤§æ¦‚5å°æ—¶å†…,é»˜è®¤ä¼šé‡è¯•16æ¬¡,  å¦‚æœå…¨éƒ¨å¤±è´¥çš„è¯å°±ä¼šåˆ°æ­»ä¿¡é˜Ÿåˆ—é‡Œé¢</li>
</ol>
<h2 id="1-ç”Ÿäº§è€…æŠ•é€’ç­–ç•¥">1. ç”Ÿäº§è€…æŠ•é€’ç­–ç•¥
</h2><ul>
<li>è½®è¯¢æŠ•é€’</li>
<li>é¡ºåºæŠ•é€’</li>
</ul>
<p>RockeMQ é‡‡ç”¨äº†è¿™ç§å®ç°æ–¹æ¡ˆï¼š<strong>å¯¹äºç›¸åŒè®¢å•å·çš„æ¶ˆæ¯ï¼Œé€šè¿‡ä¸€å®šçš„ç­–ç•¥ï¼Œå°†å…¶</strong> æ”¾ç½®åœ¨ä¸€ä¸ªqueueé˜Ÿåˆ—ä¸­ <strong>ï¼Œç„¶å</strong> æ¶ˆè´¹è€… å†é‡‡ç”¨ä¸€å®šçš„ç­–ç•¥(ä¸€ä¸ªçº¿ç¨‹ç‹¬ç«‹å¤„ç†ä¸€ä¸ªqueue ,ä¿è¯å¤„ç†æ¶ˆæ¯çš„é¡ºåºæ€§)ï¼Œèƒ½å¤Ÿä¿è¯æ¶ˆè´¹çš„é¡ºåºæ€§</p>
<pre><code class="language-java">package org.apache.rocketmq.client.producer;

import java.util.List;
import org.apache.rocketmq.common.message.Message;
import org.apache.rocketmq.common.message.MessageQueue;

public interface MessageQueueSelector {
    MessageQueue select(List&lt;MessageQueue&gt; var1, Message var2, Object var3);
}

</code></pre>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th><strong>æŠ•é€’ç­–ç•¥</strong></th>
          <th><strong>ç­–ç•¥å®ç°ç±»</strong></th>
          <th></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>éšæœºåˆ†é…ç­–ç•¥</td>
          <td>SelectMessageQueueByRandom</td>
          <td>ä½¿ç”¨äº†ç®€å•çš„éšæœºæ•°é€‰æ‹©ç®—æ³•</td>
      </tr>
      <tr>
          <td>åŸºäºHashåˆ†é…</td>
          <td>SelectMessageQueueByHash</td>
          <td>æ ¹æ®é™„åŠ å‚æ•°çš„Hashå€¼ï¼ŒæŒ‰ç…§æ¶ˆ</td>
      </tr>
  </tbody>
</table></div>
<h2 id="2-æ¶ˆè´¹è€…åˆ†é…é˜Ÿåˆ—">2. æ¶ˆè´¹è€…åˆ†é…é˜Ÿåˆ—
</h2><ul>
<li>BROADCASTING :å¹¿æ’­å¼æ¶ˆè´¹ï¼Œè¿™ç§æ¨¡å¼ä¸‹ï¼Œä¸€ä¸ªæ¶ˆæ¯ä¼šè¢«é€šçŸ¥åˆ°æ¯ä¸€ä¸ª æ¶ˆè´¹è€…</li>
<li>CLUSTERING : é›†ç¾¤å¼æ¶ˆè´¹ï¼Œè¿™ç§æ¨¡å¼ä¸‹ï¼Œä¸€ä¸ªæ¶ˆæ¯æœ€å¤šåªä¼šè¢«æŠ•é€’åˆ°ä¸€ä¸ª æ¶ˆè´¹è€… ä¸Šè¿›è¡Œæ¶ˆè´¹</li>
</ul>
<ol>
<li>
<p>å¹³å±€åˆ†é…ç®—æ³•, å¹¶ä¸æ˜¯æŒ‡çš„ä¸¥æ ¼æ„ä¹‰ä¸Šçš„å®Œå…¨å¹³å‡ï¼Œå¦‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ==10ä¸ªqueueï¼Œè€Œ æ¶ˆè´¹è€…åªæœ‰4ä¸ª==ï¼Œæ— æ³•æ˜¯æ•´é™¤å…³ç³»ï¼Œé™¤äº†æ•´é™¤ä¹‹å¤–çš„==å¤šå‡ºæ¥çš„queue,å°†ä¾æ¬¡æ ¹æ®æ¶ˆè´¹è€…çš„é¡ºåºå‡æ‘Š==ã€‚</p>
</li>
<li>
<p>ä¸€è‡´æ€§hashåˆ†é…ç®—æ³•, ä¼šå°† consumeræ¶ˆè´¹è€… ä½œä¸ºNodeèŠ‚ç‚¹æ„é€ æˆä¸€ä¸ªhashç¯ï¼Œç„¶å queueé˜Ÿåˆ— é€šè¿‡è¿™ä¸ª</p>
<p>hashç¯æ¥å†³å®šè¢«åˆ†é…ç»™å“ªä¸ª consumeræ¶ˆè´¹è€… ã€‚</p>
</li>
</ol>
<p>é»˜è®¤æ¶ˆè´¹è€…ä½¿ç”¨ä½¿ç”¨äº† AllocateMessageQueueAveragely å¹³å‡åˆ†é…ç­–ç•¥</p>
<pre><code class="language-java">//åˆ›å»ºä¸€ä¸ªæ¶ˆæ¯æ¶ˆè´¹è€…ï¼Œå¹¶è®¾ç½®ä¸€ä¸ªæ¶ˆæ¯æ¶ˆè´¹è€…ç»„ï¼Œå¹¶æŒ‡å®šä½¿ç”¨ä¸€è‡´æ€§hashç®—æ³•çš„åˆ†é…ç­–ç•¥
DefaultMQPushConsumer consumer = new
DefaultMQPushConsumer(null,&quot;rocket_test_consumer_group&quot;,null,new
AllocateMessageQueueConsistentHash());
</code></pre>
<h1 id="5--rocketmq-æ¶ˆæ¯å­˜å‚¨">5.  rocketMq æ¶ˆæ¯å­˜å‚¨
</h1><ul>
<li>CommitLogï¼šè¿™æ˜¯æ¶ˆæ¯å­˜å‚¨çš„æ ¸å¿ƒæ–‡ä»¶ï¼Œæ‰€æœ‰çš„æ¶ˆæ¯éƒ½å…ˆå†™å…¥ CommitLogã€‚å®ƒæ˜¯ä¸€ä¸ªé¡ºåºå†™çš„æ—¥å¿—æ–‡ä»¶ï¼Œå†™å…¥æ€§èƒ½é«˜ã€‚</li>
<li>ConsumeQueueï¼šè¿™æ˜¯æ¶ˆæ¯çš„é€»è¾‘é˜Ÿåˆ—ï¼Œå­˜å‚¨äº†æ¶ˆæ¯åœ¨ CommitLog ä¸­çš„ç‰©ç†åç§»é‡ã€æ¶ˆæ¯å¤§å°å’Œæ¶ˆæ¯çš„ Tag å“ˆå¸Œå€¼ã€‚æ¯ä¸ª Topic ä¸‹çš„æ¯ä¸ªé˜Ÿåˆ—éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„ ConsumeQueueã€‚</li>
<li>IndexFileï¼šè¿™æ˜¯æ¶ˆæ¯çš„ç´¢å¼•æ–‡ä»¶ï¼Œå­˜å‚¨äº†æ¶ˆæ¯çš„ç´¢å¼•ä¿¡æ¯ï¼Œå¯ä»¥é€šè¿‡æ¶ˆæ¯çš„ Key å¿«é€ŸæŸ¥æ‰¾æ¶ˆæ¯ã€‚
è¿™äº›æ–‡ä»¶éƒ½å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œ</li>
<li>Broker ä¼šå®šæœŸè¿›è¡Œåˆ·ç›˜æ“ä½œï¼Œå°†å†…å­˜ä¸­çš„æ•°æ®å†™å…¥ç£ç›˜ï¼Œä¿è¯æ¶ˆæ¯çš„æŒä¹…æ€§ã€‚</li>
</ul>
<h1 id="6-æ¶ˆæ¯ä¿éšœ">6. æ¶ˆæ¯ä¿éšœ
</h1><h2 id="1-ç”Ÿäº§ç«¯ä¿éšœ">1. ç”Ÿäº§ç«¯ä¿éšœ
</h2><ol>
<li>
<p>ä½¿ç”¨å¯é çš„æ¶ˆæ¯å‘é€æ–¹å¼,    åŒæ­¥å‘é€æ¯”å¼‚æ­¥å‘é€å¯é ,  ==ä¸¤è€…éƒ½å¯ä»¥å¯¹æ¶ˆæ¯çš„å“åº”ç»“æœåšå¤„ç†==, åªæœ‰one-way(å•å‘æ¨¡å¼) çš„æ—¶å€™æ‰ä¼šä¸éœ€è¦å¤„ç†, è€Œä¸”==åªæœ‰åŒæ­¥å‘é€æ‰æœ‰é‡è¯•==, ==å¹¶ä¸”è¶…æ—¶æ˜¯ä¸ä¼šè¿›è¡Œé‡è¯•çš„==</p>
</li>
<li>
<p>æ³¨æ„ç”Ÿäº§ç«¯é‡è¯•</p>
</li>
<li>
<p>ç”Ÿäº§ç¦æ­¢è‡ªåŠ¨åˆ›å»ºtopic</p>
</li>
</ol>
<p>å‘é€é‡è¯•æºç </p>
<pre><code class="language-java">/**
     * è¯´æ˜ æŠ½å–éƒ¨åˆ†ä»£ç 
     */
    private SendResult sendDefaultImpl(Message msg, final CommunicationMode
            communicationMode, final SendCallback sendCallback, final long timeout) {
//1ã€è·å–å½“å‰æ—¶é—´
        long beginTimestampFirst = System.currentTimeMillis();
        long beginTimestampPrev ;
//2ã€å»æœåŠ¡å™¨çœ‹ä¸‹æœ‰æ²¡æœ‰ä¸»é¢˜æ¶ˆæ¯
        TopicPublishInfo topicPublishInfo =
                this.tryToFindTopicPublishInfo(msg.getTopic());
        if (topicPublishInfo != null &amp;&amp; topicPublishInfo.ok()) {
            boolean callTimeout = false;
//3ã€é€šè¿‡è¿™é‡Œå¯ä»¥å¾ˆæ˜æ˜¾çœ‹å‡º å¦‚æœä¸æ˜¯åŒæ­¥å‘é€æ¶ˆæ¯ é‚£ä¹ˆæ¶ˆæ¯é‡è¯•åªæœ‰1æ¬¡
            int timesTotal = communicationMode == CommunicationMode.SYNC ? 1 +
                    this.defaultMQProducer.getRetryTimesWhenSendFailed() : 1;
//4ã€æ ¹æ®è®¾ç½®çš„é‡è¯•æ¬¡æ•°ï¼Œå¾ªç¯å†å»è·å–æœåŠ¡å™¨ä¸»é¢˜æ¶ˆæ¯
            for (times = 0; times &lt; timesTotal; times++) {
                MessageQueue mqSelected =
                        this.selectOneMessageQueue(topicPublishInfo, lastBrokerName);
                beginTimestampPrev = System.currentTimeMillis();
                long costTime = beginTimestampPrev - beginTimestampFirst;
//5ã€å‰åæ—¶é—´å¯¹æ¯” å¦‚æœå‰åæ—¶é—´å·® å¤§äº è®¾ç½®çš„ç­‰å¾…æ—¶é—´ é‚£ä¹ˆç›´æ¥è·³å‡ºforå¾ªç¯äº† è¿™å°±
                è¯´æ˜è¿æ¥è¶…æ—¶æ˜¯ä¸è¿›è¡Œå¤šæ¬¡è¿æ¥é‡è¯•çš„
                if (timeout &lt; costTime) {
                    callTimeout = true;
                    break
                }
//6ã€å¦‚æœè¶…æ—¶ç›´æ¥æŠ¥é”™
                if (callTimeout) {
                    throw new RemotingTooMuchRequestException(&quot;sendDefaultImpl call
                            timeout&quot;);
                }
            }
        }
}
</code></pre>
<p>==è‡ªåŠ¨åˆ›å»ºtopic==</p>
<p>autoCreateTopicEnable è®¾ç½®ä¸ºtrue æ ‡è¯†å¼€å¯è‡ªåŠ¨åˆ›å»ºtopic</p>
<ol>
<li>æ¶ˆæ¯å‘é€æ—¶å¦‚æœæ ¹æ®topicæ²¡æœ‰è·å–åˆ° è·¯ç”±ä¿¡æ¯ï¼Œåˆ™ä¼šæ ¹æ®é»˜è®¤çš„topicå»è·å–ï¼Œè·å–åˆ°è·¯ç”±ä¿¡æ¯å</li>
</ol>
<p>é€‰æ‹©ä¸€ä¸ªé˜Ÿåˆ—è¿›è¡Œå‘é€ï¼Œå‘é€æ—¶æŠ¥æ–‡ä¼šå¸¦ä¸Šé»˜è®¤çš„topicä»¥åŠé»˜è®¤çš„é˜Ÿåˆ—æ•°é‡ã€‚</p>
<ol start="2">
<li>æ¶ˆæ¯åˆ°è¾¾brokeråï¼Œbrokeræ£€æµ‹æ²¡æœ‰topicçš„è·¯ç”±ä¿¡æ¯ï¼Œåˆ™æŸ¥æ‰¾é»˜è®¤topicçš„è·¯ç”±ä¿¡æ¯ï¼ŒæŸ¥åˆ°è¡¨ç¤ºå¼€</li>
</ol>
<p>å¯äº†è‡ªåŠ¨åˆ›å»ºtopicï¼Œåˆ™ä¼šæ ¹æ®æ¶ˆæ¯å†…å®¹ä¸­çš„é»˜è®¤çš„é˜Ÿåˆ—æ•°é‡åœ¨æœ¬brokerä¸Šåˆ›å»ºtopicï¼Œç„¶åè¿›è¡Œæ¶ˆ</p>
<p>æ¯å­˜å‚¨ã€‚</p>
<ol start="3">
<li><strong>brokeråˆ›å»ºtopicåå¹¶ä¸ä¼šé©¬ä¸ŠåŒæ­¥ç»™namesrv</strong>ï¼Œè€Œæ˜¯æ¯30è¿›è¡Œæ±‡æŠ¥ä¸€æ¬¡ï¼Œæ›´æ–°namesrvä¸Šçš„ topicè·¯ç”±ä¿¡æ¯ï¼Œproducerä¼šæ¯30sè¿›è¡Œæ‹‰å–ä¸€æ¬¡topicçš„è·¯ç”±ä¿¡æ¯ï¼Œæ›´æ–°å®Œæˆåå°±å¯ä»¥æ­£å¸¸å‘é€æ¶ˆ æ¯ã€‚æ›´æ–°ä¹‹å‰ä¸€ç›´éƒ½æ˜¯æŒ‰ç…§é»˜è®¤çš„topicæŸ¥æ‰¾è·¯ç”±ä¿¡æ¯ã€‚</li>
</ol>
<h2 id="2-æ¶ˆè´¹ç«¯ä¿éšœ">2. æ¶ˆè´¹ç«¯ä¿éšœ
</h2><h3 id="1-æ¶ˆæ¯ç¡®è®¤">1. æ¶ˆæ¯ç¡®è®¤
</h3><p>ä¸šåŠ¡å®ç°æ¶ˆè´¹å›è°ƒçš„æ—¶å€™ï¼Œå½“ä¸”ä»…å½“æ­¤å›è°ƒå‡½æ•°è¿”å› ==ConsumeConcurrentlyStatus.CONSUME_SUCCESS== ï¼ŒRocketMQæ‰ä¼šè®¤ä¸ºè¿™æ‰¹æ¶ˆæ¯ï¼ˆé»˜è®¤æ˜¯1 æ¡ï¼‰æ˜¯æ¶ˆè´¹å®Œæˆçš„ã€‚</p>
<h3 id="2-æ¶ˆè´¹å¼‚å¸¸">2. <strong>æ¶ˆè´¹å¼‚å¸¸</strong>
</h3><p>æ•°æ®åº“å¼‚å¸¸ï¼Œä½™é¢ä¸è¶³æ‰£æ¬¾å¤±è´¥ç­‰ä¸€åˆ‡ä¸šåŠ¡è®¤ä¸ºæ¶ˆæ¯éœ€è¦é‡è¯•çš„åœº æ™¯ï¼Œåªè¦è¿”å› ==ConsumeConcurrentlyStatus.RECONSUME_LATER== ï¼ŒRocketMQå°±ä¼šè®¤ä¸ºè¿™æ‰¹æ¶ˆæ¯ æ¶ˆè´¹å¤±è´¥äº†ã€‚</p>
<p>ä¸ºäº†ä¿è¯æ¶ˆæ¯æ˜¯è‚¯å®šè¢«è‡³å°‘æ¶ˆè´¹æˆåŠŸä¸€æ¬¡ï¼ŒRocketMQä¼šæŠŠè¿™æ‰¹æ¶ˆæ¯é‡å‘å›Brokerï¼ˆ==topicä¸æ˜¯åŸ topicè€Œæ˜¯è¿™ä¸ªæ¶ˆè´¹ç§Ÿçš„RETRY topic==ï¼‰ï¼Œåœ¨å»¶è¿Ÿçš„æŸä¸ªæ—¶é—´ç‚¹ï¼ˆé»˜è®¤æ˜¯10ç§’ï¼Œä¸šåŠ¡å¯è®¾ç½®ï¼‰åï¼Œ==å†æ¬¡æŠ• é€’åˆ°è¿™ä¸ªConsumerGroup==ã€‚è€Œå¦‚æœä¸€ç›´è¿™æ ·é‡å¤æ¶ˆè´¹éƒ½æŒç»­å¤±è´¥åˆ°ä¸€å®šæ¬¡æ•°ï¼ˆé»˜è®¤16æ¬¡ï¼‰ï¼Œå°±ä¼š==æŠ•é€’ åˆ°DLQæ­»ä¿¡é˜Ÿåˆ—==ã€‚åº”ç”¨å¯ä»¥ç›‘æ§æ­»ä¿¡é˜Ÿåˆ—æ¥åšäººå·¥å¹²é¢„ã€‚</p>
<h2 id="3-æ­»ä¿¡é˜Ÿåˆ—">3. æ­»ä¿¡é˜Ÿåˆ—
</h2><p>å½“ä¸€æ¡æ¶ˆæ¯åˆæ¬¡æ¶ˆè´¹å¤±è´¥ï¼Œæ¶ˆæ¯é˜Ÿåˆ— RocketMQ ä¼šè‡ªåŠ¨è¿›è¡Œæ¶ˆæ¯é‡è¯•ï¼›</p>
<p>è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡ æ•°åï¼Œè‹¥ æ¶ˆè´¹ä¾ç„¶å¤±è´¥ï¼Œåˆ™è¡¨æ˜æ¶ˆè´¹è€…åœ¨æ­£å¸¸æƒ…å†µä¸‹æ— æ³•æ­£ç¡®åœ°æ¶ˆè´¹è¯¥æ¶ˆæ¯ï¼Œ</p>
<p>æ­¤æ—¶ï¼Œæ¶ˆæ¯é˜Ÿåˆ— RocketMQ ä¸ä¼šç«‹ åˆ»å°†æ¶ˆæ¯ä¸¢å¼ƒï¼Œè€Œæ˜¯å°†å…¶å‘é€åˆ°è¯¥æ¶ˆè´¹è€…å¯¹åº”çš„ç‰¹æ®Šé˜Ÿåˆ—ä¸­ã€‚ åœ¨æ¶ˆæ¯é˜Ÿåˆ— RocketMQ ä¸­ï¼Œè¿™ç§æ­£å¸¸æƒ…å†µ ä¸‹æ— æ³•è¢«æ¶ˆè´¹çš„æ¶ˆæ¯ç§°ä¸ºæ­»ä¿¡æ¶ˆæ¯ï¼Œå­˜å‚¨æ­»ä¿¡æ¶ˆæ¯çš„ç‰¹æ®Šé˜Ÿåˆ—ç§°ä¸ºæ­»ä¿¡é˜Ÿåˆ—</p>
<p>==ä¸ä¼šå†è¢«æ¶ˆè´¹è€…æ­£å¸¸æ¶ˆè´¹==</p>
<p>æœ‰æ•ˆæœŸä¸æ­£å¸¸æ¶ˆæ¯ç›¸åŒï¼Œå‡ä¸º 3 å¤©ï¼Œ3 å¤©åä¼šè¢«è‡ªåŠ¨åˆ é™¤ã€‚æ•…æ­»ä¿¡æ¶ˆæ¯åº”åœ¨äº§ç”Ÿçš„ 3 å¤©å†…åŠæ—¶å¤„ç†</p>
<p>==ä¸€ä¸ªæ­»ä¿¡é˜Ÿåˆ—å¯¹åº”ä¸€ä¸ªæ¶ˆè´¹è€…ç»„ï¼Œè€Œä¸æ˜¯å¯¹åº”å•ä¸ªæ¶ˆè´¹è€…å®ä¾‹==</p>
<p>ä¸€ä¸ªæ­»ä¿¡é˜Ÿåˆ—åŒ…å«äº†å¯¹åº”çš„ ==Group IDæ‰€äº§ç”Ÿçš„æ‰€æœ‰æ­»ä¿¡æ¶ˆæ¯ï¼Œä¸è®ºè¯¥æ¶ˆæ¯å±äºå“ªä¸ªTopicè‹¥ä¸€ä¸ª Group ID æ²¡æœ‰äº§ç”Ÿè¿‡æ­»ä¿¡æ¶ˆæ¯ï¼Œåˆ™ RocketMQ ä¸ä¼šä¸ºå…¶åˆ›å»ºç›¸åº”çš„æ­»ä¿¡é˜Ÿåˆ—==</p>
<h1 id="7-åº”ç”¨">7. åº”ç”¨
</h1><h2 id="1-spring-cloud-stream-æ•´åˆ">1. spring cloud stream æ•´åˆ
</h2><p>ä»¥ç»Ÿä¸€çš„ä¸€å¥—APIæ¥è¿›è¡Œæ¶ˆæ¯çš„å‘é€å’Œæ¶ˆè´¹, åº•å±‚æ¶ˆæ¯ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚ç”±å„æ¶ˆæ¯ä¸­é—´ä»¶çš„ binder å®Œæˆ</p>
<blockquote>
<p><a class="link" href="https://www.jianshu.com/p/7f8fd90564ca?utm_campaign=hugo"  target="_blank" rel="noopener"
    >https://www.jianshu.com/p/7f8fd90564ca?utm_campaign=hugo</a></p>
<p>gitee: <a class="link" href="https://gitee.com/jbcode/GitRepository.git"  target="_blank" rel="noopener"
    >https://gitee.com/jbcode/GitRepository.git</a></p>
</blockquote>
<h3 id="1-ä¾èµ–">1. ä¾èµ–
</h3><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;

    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;groupId&gt;com.erbadagang.springcloud.stream&lt;/groupId&gt;
    &lt;artifactId&gt;sc-stream-rocketmq-producer&lt;/artifactId&gt;
    &lt;version&gt;0.0.1&lt;/version&gt;

    &lt;properties&gt;
        &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;
        &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;
        &lt;spring.boot.version&gt;2.2.4.RELEASE&lt;/spring.boot.version&gt;
        &lt;spring.cloud.version&gt;Hoxton.SR1&lt;/spring.cloud.version&gt;
        &lt;spring.cloud.alibaba.version&gt;2.2.0.RELEASE&lt;/spring.cloud.alibaba.version&gt;
    &lt;/properties&gt;

    &lt;!--
        å¼•å…¥ Spring Bootã€Spring Cloudã€Spring Cloud Alibaba ä¸‰è€… BOM æ–‡ä»¶ï¼Œè¿›è¡Œä¾èµ–ç‰ˆæœ¬çš„ç®¡ç†ï¼Œé˜²æ­¢ä¸å…¼å®¹ã€‚
        åœ¨ https://dwz.cn/mcLIfNKt æ–‡ç« ä¸­ï¼ŒSpring Cloud Alibaba å¼€å‘å›¢é˜Ÿæ¨èäº†ä¸‰è€…çš„ä¾èµ–å…³ç³»
     --&gt;
    &lt;dependencyManagement&gt;
        &lt;dependencies&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
                &lt;version&gt;${spring.boot.version}&lt;/version&gt;
                &lt;type&gt;pom&lt;/type&gt;
                &lt;scope&gt;import&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
                &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;
                &lt;version&gt;${spring.cloud.version}&lt;/version&gt;
                &lt;type&gt;pom&lt;/type&gt;
                &lt;scope&gt;import&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
                &lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt;
                &lt;version&gt;${spring.cloud.alibaba.version}&lt;/version&gt;
                &lt;type&gt;pom&lt;/type&gt;
                &lt;scope&gt;import&lt;/scope&gt;
            &lt;/dependency&gt;
        &lt;/dependencies&gt;
    &lt;/dependencyManagement&gt;

    &lt;dependencies&gt;
        &lt;!-- å¼•å…¥ SpringMVC ç›¸å…³ä¾èµ–ï¼Œå¹¶å®ç°å¯¹å…¶çš„è‡ªåŠ¨é…ç½® --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;!-- å¼•å…¥ Spring Cloud Alibaba Stream RocketMQ ç›¸å…³ä¾èµ–ï¼Œå°† RocketMQ ä½œä¸ºæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¹¶å®ç°å¯¹å…¶çš„è‡ªåŠ¨é…ç½® --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-stream-rocketmq&lt;/artifactId&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

&lt;/project&gt;
</code></pre>
<h3 id="2-ç”Ÿäº§ç«¯é…ç½®æ–‡ä»¶">2. ç”Ÿäº§ç«¯é…ç½®æ–‡ä»¶
</h3><pre><code class="language-yaml">spring:
  application:
    name: stream-rocketmq-producer-application
  cloud:
    # Spring Cloud Stream é…ç½®é¡¹ï¼Œå¯¹åº” BindingServiceProperties ç±»
    stream:
      # Binding é…ç½®é¡¹ï¼Œå¯¹åº” BindingProperties Map
      bindings:
        erbadagang-output:
          destination: ERBADAGANG-TOPIC-01 # ç›®çš„åœ°ã€‚è¿™é‡Œä½¿ç”¨ RocketMQ Topic
          content-type: application/json # å†…å®¹æ ¼å¼ã€‚è¿™é‡Œä½¿ç”¨ JSON

        trek-output:
          destination: TREK-TOPIC-01 # ç›®çš„åœ°ã€‚è¿™é‡Œä½¿ç”¨ RocketMQ Topic
          content-type: application/json # å†…å®¹æ ¼å¼ã€‚è¿™é‡Œä½¿ç”¨ JSON
      # Spring Cloud Stream RocketMQ é…ç½®é¡¹
      rocketmq:
        # RocketMQ Binder é…ç½®é¡¹ï¼Œå¯¹åº” RocketMQBinderConfigurationProperties ç±»
        binder:
          name-server: 101.133.227.13:9876 # RocketMQ Namesrv åœ°å€
        # RocketMQ è‡ªå®šä¹‰ Binding é…ç½®é¡¹ï¼Œå¯¹åº” RocketMQBindingProperties Map
        bindings:
          erbadagang-output:
            # RocketMQ Producer é…ç½®é¡¹ï¼Œå¯¹åº” RocketMQProducerProperties ç±»
            producer:
              group: test # ç”Ÿäº§è€…åˆ†ç»„
              sync: true # æ˜¯å¦åŒæ­¥å‘é€æ¶ˆæ¯ï¼Œé»˜è®¤ä¸º false å¼‚æ­¥ã€‚

server:
  port: 18080

# åŒæ—¶æˆ‘ä»¬è®¾ç½®äº†2ä¸ªbindingï¼Œæ¨¡æ‹Ÿ2ä¸ªtopicæƒ…å½¢ã€‚
</code></pre>
<h3 id="3--æ¶ˆè´¹ç«¯é…ç½®æ–‡ä»¶">3.  æ¶ˆè´¹ç«¯é…ç½®æ–‡ä»¶
</h3><pre><code class="language-yaml">spring:
  application:
    name: erbadagang-consumer-application
  cloud:
    # Spring Cloud Stream é…ç½®é¡¹ï¼Œå¯¹åº” BindingServiceProperties ç±»
    stream:
      # Binding é…ç½®é¡¹ï¼Œå¯¹åº” BindingProperties Map
      bindings:
        erbadagang-input:
          destination: ERBADAGANG-TOPIC-01 # ç›®çš„åœ°ã€‚è¿™é‡Œä½¿ç”¨ RocketMQ Topic
          content-type: application/json # å†…å®¹æ ¼å¼ã€‚è¿™é‡Œä½¿ç”¨ JSON
          group: erbadagang-consumer-group-ERBADAGANG-TOPIC-01 # æ¶ˆè´¹è€…åˆ†ç»„,å‘½åè§„åˆ™ï¼šç»„å+topicå

        trek-input:
          destination: TREK-TOPIC-01 # ç›®çš„åœ°ã€‚è¿™é‡Œä½¿ç”¨ RocketMQ Topic
          content-type: application/json # å†…å®¹æ ¼å¼ã€‚è¿™é‡Œä½¿ç”¨ JSON
          group: trek-consumer-group-TREK-TOPIC-01 # æ¶ˆè´¹è€…åˆ†ç»„,å‘½åè§„åˆ™ï¼šç»„å+topicå
      # Spring Cloud Stream RocketMQ é…ç½®é¡¹
      rocketmq:
        # RocketMQ Binder é…ç½®é¡¹ï¼Œå¯¹åº” RocketMQBinderConfigurationProperties ç±»
        binder:
          name-server: 101.133.227.13:9876 # RocketMQ Namesrv åœ°å€
        # RocketMQ è‡ªå®šä¹‰ Binding é…ç½®é¡¹ï¼Œå¯¹åº” RocketMQBindingProperties Map
        bindings:
          erbadagang-input:
            # RocketMQ Consumer é…ç½®é¡¹ï¼Œå¯¹åº” RocketMQConsumerProperties ç±»
            consumer:
              enabled: true # æ˜¯å¦å¼€å¯æ¶ˆè´¹ï¼Œé»˜è®¤ä¸º true
              broadcasting: false # æ˜¯å¦ä½¿ç”¨å¹¿æ’­æ¶ˆè´¹ï¼Œé»˜è®¤ä¸º false ä½¿ç”¨é›†ç¾¤æ¶ˆè´¹ï¼Œå¦‚æœè¦ä½¿ç”¨å¹¿æ’­æ¶ˆè´¹å€¼è®¾æˆtrueã€‚

server:
  port: ${random.int[10000,19999]} # éšæœºç«¯å£ï¼Œæ–¹ä¾¿å¯åŠ¨å¤šä¸ªæ¶ˆè´¹è€…
</code></pre>
<ol>
<li>å‘é€æ¶ˆæ¯ @OutPut</li>
<li>æ¥å—æ¶ˆæ¯ @ Input</li>
</ol>
<h2 id="2-springboot-é›†æˆ-rocketmq">2. springboot é›†æˆ rocketMq
</h2><h3 id="1-çŸ¥è¯†ç‚¹-æ³›å‹æ–¹æ³•">1. çŸ¥è¯†ç‚¹: æ³›å‹æ–¹æ³•
</h3><pre><code class="language-java">private static &lt;T&gt; void getConsumer() {

}
</code></pre>
<blockquote>
<p><a class="link" href="https://blog.csdn.net/zxl646801924/article/details/105659481"  target="_blank" rel="noopener"
    >https://blog.csdn.net/zxl646801924/article/details/105659481</a></p>
</blockquote>
<h3 id="2-rocketmq-spring-boot-starter">2. rocketmq-spring-boot-starter
</h3><blockquote>
<p><a class="link" href="https://blog.csdn.net/m0_37968982/article/details/109066088"  target="_blank" rel="noopener"
    >https://blog.csdn.net/m0_37968982/article/details/109066088</a></p>
</blockquote>
<h4 id="1-å¼•å…¥ä¾èµ–">1. å¼•å…¥ä¾èµ–
</h4><pre><code class="language-properties">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.rocketmq&lt;/groupId&gt;
    &lt;artifactId&gt;rocketmq-spring-boot-starter&lt;/artifactId&gt;
    &lt;version&gt;2.1.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h4 id="2-é…ç½®rocketmq">2. é…ç½®rocketMq
</h4><pre><code class="language-yaml">rocketmq:
  name-server: 127.0.0.1:9876
  producer:
    group: my-producer-group
</code></pre>
<h4 id="3-æ„å»ºç”Ÿäº§è€…">3. æ„å»ºç”Ÿäº§è€…
</h4><pre><code class="language-java">@RestController
public class Producer {

    @Autowired
    private RocketMQTemplate rocketMQTemplate;

    @GetMapping(&quot;send&quot;)
    public void send(){

        rocketMQTemplate.convertAndSend(&quot;first-topic&quot;,&quot;ä½ å¥½,Javaæ—…é€”&quot;);
    }
}
</code></pre>
<h4 id="4-æ¶ˆè´¹è€…">4. æ¶ˆè´¹è€…
</h4><pre><code>@Component
@RocketMQMessageListener(topic = &quot;first-topic&quot;,consumerGroup = &quot;my-consumer-group&quot;)
@Slf4j
public class Consumer implements RocketMQListener&lt;String&gt; {

    @Override
    public void onMessage(String message) {
        log.info(&quot;æˆ‘æ”¶åˆ°æ¶ˆæ¯äº†ï¼æ¶ˆæ¯å†…å®¹ä¸ºï¼š&quot;+message);
    }
}
</code></pre>
<h2 id="3-æ‰“è½¦æœåŠ¡">3. æ‰“è½¦æœåŠ¡
</h2><h3 id="1-è½¦è¾†è°ƒåº¦">1. è½¦è¾†è°ƒåº¦
</h3><p><img src="/p/rocketmq/images/image-20240612163426938.png"
	width="1187"
	height="748"
	
	loading="lazy"
	
		alt="image-20240612163426938"
	
	
		class="gallery-image" 
		data-flex-grow="158"
		data-flex-basis="380px"
	
></p>
<h3 id="2-å¸æœºè‡ªåŠ¨æ¥å•">2. å¸æœºè‡ªåŠ¨æ¥å•
</h3><p><img src="/p/rocketmq/images/image-20240612163538833.png"
	width="1220"
	height="493"
	
	loading="lazy"
	
		alt="image-20240612163538833"
	
	
		class="gallery-image" 
		data-flex-grow="247"
		data-flex-basis="593px"
	
></p>
<h3 id="3-ç”¨æˆ·ä¸‹è½¦">3. ç”¨æˆ·ä¸‹è½¦
</h3><p><img src="/p/rocketmq/images/image-20240612163602860.png"
	width="1168"
	height="763"
	
	loading="lazy"
	
		alt="image-20240612163602860"
	
	
		class="gallery-image" 
		data-flex-grow="153"
		data-flex-basis="367px"
	
></p>
<h3 id="4-æ€»ä½“æµç¨‹">4. æ€»ä½“æµç¨‹
</h3><p><img src="/p/rocketmq/images/image-20240612163932221.png"
	width="1212"
	height="730"
	
	loading="lazy"
	
		alt="image-20240612163932221"
	
	
		class="gallery-image" 
		data-flex-grow="166"
		data-flex-basis="398px"
	
></p>
<h2 id="4--rocketmqpushconsumerlifecyclelistener-æ¥å£">4.  RocketMQPushConsumerLifecycleListener æ¥å£
</h2><p><code>RocketMQPushConsumerLifecycleListener</code> æ˜¯ä¸€ä¸ªç”¨äºç®¡ç† RocketMQ æ¨é€æ¶ˆè´¹è€…ç”Ÿå‘½å‘¨æœŸçš„æ¥å£ã€‚å®ç°è¿™ä¸ªæ¥å£çš„ç±»å¯ä»¥åœ¨==æ¶ˆè´¹è€…å¯åŠ¨å‰å’Œå¯åŠ¨åæ‰§è¡Œä¸€äº›è‡ªå®šä¹‰é€»è¾‘==ã€‚</p>
<p>ç¤ºä¾‹</p>
<pre><code class="language-java">public class MyConsumerLifecycleListener implements RocketMQPushConsumerLifecycleListener {

    @Override
    public void prepareStart(DefaultMQPushConsumer consumer) {
        // åœ¨æ¶ˆè´¹è€…å¯åŠ¨å‰æ‰§è¡Œä¸€äº›åˆå§‹åŒ–æ“ä½œ
        consumer.setConsumeThreadMax(10); // è®¾ç½®æœ€å¤§æ¶ˆè´¹çº¿ç¨‹æ•°
        System.out.println(&quot;Consumer is about to start.&quot;);
    }

    @Override
    public void prepareShutdown(DefaultMQPushConsumer consumer) {
        // åœ¨æ¶ˆè´¹è€…å…³é—­å‰æ‰§è¡Œä¸€äº›æ¸…ç†æ“ä½œ
        System.out.println(&quot;Consumer is about to shut down.&quot;);
    }
}

</code></pre>
<h1 id="8--ä»»åŠ¡">8.  ä»»åŠ¡
</h1><ol>
<li><del>å¤ä¹ æ–‡æ¡£</del></li>
<li>æ•´ç†é¢è¯•é¢˜</li>
<li>æŸ¥çœ‹ä»£ç ä½¿ç”¨</li>
<li><del>å¤è¿° rocket æ‰“è½¦</del></li>
<li><del>æ­å»ºä¸€ä¸ªæœ¬æœºçš„ rocketMq</del></li>
<li>kafka è¿›è¡Œå­¦ä¹ </li>
</ol>
<h1 id="9-rocketmq-çš„äº‹åŠ¡æ¶ˆæ¯">9. RocketMq çš„äº‹åŠ¡æ¶ˆæ¯
</h1><p>é¢è¯•å®˜ï¼šä»€ä¹ˆæ˜¯RocketMQçš„äº‹åŠ¡æ¶ˆæ¯</p>
<p>äº‹åŠ¡æ¶ˆæ¯å°±æ˜¯MQæä¾›çš„ç±»ä¼¼XAçš„åˆ†å¸ƒå¼äº‹åŠ¡èƒ½åŠ›ï¼Œé€šè¿‡äº‹åŠ¡æ¶ˆæ¯å¯ä»¥è¾¾åˆ°åˆ†å¸ƒå¼äº‹åŠ¡çš„æœ€ç»ˆä¸€è‡´æ€§ã€‚</p>
<p>åŠäº‹åŠ¡æ¶ˆæ¯å°±æ˜¯MQæ”¶åˆ°äº†ç”Ÿäº§è€…çš„æ¶ˆæ¯ï¼Œä½†æ˜¯æ²¡æœ‰æ”¶åˆ°äºŒæ¬¡ç¡®è®¤ï¼Œä¸èƒ½æŠ•é€’çš„æ¶ˆæ¯ã€‚</p>
<p><strong>4.1</strong> <strong>å®ç°åŸç†</strong></p>
<ol>
<li>
<p>ç”Ÿäº§è€…å…ˆå‘é€ä¸€æ¡åŠäº‹åŠ¡æ¶ˆæ¯åˆ°MQ</p>
</li>
<li>
<p>MQæ”¶åˆ°æ¶ˆæ¯åè¿”å›ackç¡®è®¤</p>
</li>
<li>
<p>ç”Ÿäº§è€…å¼€å§‹æ‰§è¡Œæœ¬åœ°äº‹åŠ¡</p>
</li>
<li>
<p>å¦‚æœäº‹åŠ¡æ‰§è¡ŒæˆåŠŸå‘é€commitåˆ°MQï¼Œå¤±è´¥å‘é€rollback</p>
</li>
<li>
<p>å¦‚æœMQé•¿æ—¶é—´æœªæ”¶åˆ°ç”Ÿäº§è€…çš„äºŒæ¬¡ç¡®è®¤commitæˆ–è€…rollbackï¼ŒMQå¯¹ç”Ÿäº§è€…å‘èµ·æ¶ˆæ¯å›æŸ¥</p>
</li>
<li>
<p>ç”Ÿäº§è€…æŸ¥è¯¢äº‹åŠ¡æ‰§è¡Œæœ€ç»ˆçŠ¶æ€</p>
</li>
<li>
<p>æ ¹æ®æŸ¥è¯¢äº‹åŠ¡çŠ¶æ€å†æ¬¡æäº¤äºŒæ¬¡ç¡®è®¤</p>
</li>
</ol>
<p>æœ€ç»ˆï¼Œå¦‚æœMQæ”¶åˆ°äºŒæ¬¡ç¡®è®¤commitï¼Œå°±å¯ä»¥æŠŠæ¶ˆæ¯æŠ•é€’ç»™æ¶ˆè´¹è€…ï¼Œåä¹‹å¦‚æœæ˜¯rollbackï¼Œæ¶ˆæ¯ä¼šä¿å­˜ä¸‹æ¥å¹¶ä¸”åœ¨==3å¤©åè¢«åˆ é™¤==ã€‚</p>
<p><img src="/p/rocketmq/images/image-20220217104845523.png"
	width="713"
	height="289"
	
	loading="lazy"
	
		alt="image-20220217104845523"
	
	
		class="gallery-image" 
		data-flex-grow="246"
		data-flex-basis="592px"
	
></p>
<h1 id="10-æ¶ˆè´¹è€…é—²ç½®">10. æ¶ˆè´¹è€…é—²ç½®
</h1><p>åœ¨ä½¿ç”¨ RocketMQ æ—¶ï¼Œå¦‚æœå­˜åœ¨å¤šä¸ªæ¶ˆè´¹è€…ï¼Œä½†æŸäº›æ¶ˆè´¹è€…é—²ç½®ä¸æ¥æ”¶æ¶ˆæ¯</p>
<p>æ¶ˆè´¹è€…åˆ†ç»„åœ¨ RocketMQ ä¸­èµ·ç€é‡è¦ä½œç”¨ã€‚ä¸€ä¸ªæ¶ˆè´¹è€…åˆ†ç»„ä¸­çš„æ‰€æœ‰æ¶ˆè´¹è€…å…±åŒæ¶ˆè´¹ä¸»é¢˜ä¸­çš„æ¶ˆæ¯ã€‚æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆqueueï¼‰ä¼šåœ¨åŒä¸€ä¸ªåˆ†ç»„çš„æ¶ˆè´¹è€…ä¹‹é—´å‡åŒ€åˆ†é…ï¼š</p>
<ul>
<li><strong>æ¶ˆè´¹è€…åˆ†ç»„å†…éƒ¨çš„æ¶ˆè´¹è€…ä¸å‡è¡¡</strong>ï¼š==å¦‚æœæ¶ˆè´¹è€…æ•°é‡å¤§äºæ¶ˆæ¯é˜Ÿåˆ—çš„æ•°é‡==ï¼Œåˆ™å¤šå‡ºçš„æ¶ˆè´¹è€…ä¼šé—²ç½®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªä¸»é¢˜æœ‰4ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œä½†æœ‰5ä¸ªæ¶ˆè´¹è€…åœ¨åŒä¸€ä¸ªåˆ†ç»„å†…ï¼Œé‚£ä¹ˆå¤šå‡ºçš„ä¸€ä¸ªæ¶ˆè´¹è€…å°†ä¸ä¼šåˆ†é…åˆ°ä»»ä½•é˜Ÿåˆ—ï¼Œä»è€Œé—²ç½®ã€‚</li>
<li>==ç±»ä¼¼äºkafka ä¸­çš„åˆ†åŒºæ•°é‡å°‘äº æ¶ˆè´¹è€…æ•°é‡==</li>
</ul>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/rocketmq/">RocketMq</a>
        
            <a href="/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">æ¶ˆæ¯é˜Ÿåˆ—</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2019 - 
        
        2025 LexqinMike
    </section>
    
    <section class="powerby">
        
            ä½ æ°¸è¿œä¸çŸ¥é“ï¼Œæˆ‘çš„ä»£ç é‡Œè—äº†å¤šå°‘æ•…äº‹ã€‚ <br/>
        ä½¿ç”¨ <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> æ„å»º <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.29.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
<div id="particles-js"></div>

<script src=https://mikeLing-qx.github.io/background/particles.min.js></script>
<script>
  particlesJS.load('particles-js', "https://mikeLing-qx.github.io/background/particlesjs-config.json", function() {
    console.log('particles.js loaded - callback');
  });
</script>

<style>
  #particles-js {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    z-index: -1;
  }
</style>

<style>
  body {
    background: url(https://mikeLing-qx.github.io/background/background-01.png) no-repeat center top;
    background-size: cover;
    background-attachment: fixed;
  }
</style>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js"></script>
		<script>hljs.highlightAll();</script>
    </body>
</html>
